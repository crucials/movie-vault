(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=o(t);fetch(t.href,r)}})();function w(e){const o=new Date().getTime()-e.getTime(),s=1e3*60*60*24;return Math.round(o/s)}function q(e){const n=Math.floor(e/60),o=e%60;return{hours:n,minutes:o}}const E="https://www.imdb.com/title";let u;const v="/movie-vault/";window.addEventListener("load",async()=>{const e=document.querySelector(".movies"),n=document.querySelector("#movieCardTemplate");u=new Proxy({value:[]},{set(t,r,c){return t.value=c,o(),!0}}),L();function o(){var t;e&&(e.innerHTML="",u.value.length==0?(t=document.querySelector(".no-results-text"))==null||t.classList.add("no-results-text-visible"):u.value.forEach(r=>{e.insertAdjacentElement("beforeend",s(r))}))}function s(t){var d,m;const r=(d=n.content.firstElementChild)==null?void 0:d.cloneNode(!0),c=document.createElement("img");c.src=t.posterUrl,c.alt=t.title,c.classList.add("movie-thumbnail"),(m=r.querySelector("header"))==null||m.insertAdjacentElement("afterbegin",c);const f=r.querySelector(".movie-title");f.insertAdjacentText("afterbegin",t.title),f.href=t.moreInfoPageUrl;const i=r.querySelector(".movie-runtime");if(t.runtime){const{hours:a,minutes:l}=q(Number(t.runtime.split(" ")[0]));i==null||i.insertAdjacentText("afterbegin",t.runtime),i.dateTime=`PT${a}H${l}M`}else i.remove();t.genres.forEach(a=>{var l;(l=r.querySelector(".genres-list"))==null||l.insertAdjacentHTML("beforeend",`
                        <li class="movie-genre">
                            ${a}
                        </li>
                    `)});const g=r.querySelector(".watch-button");return g.href=t.moreInfoPageUrl,r}});async function L(e){const n=document.querySelector(".loading-indicator");if(e)n==null||n.classList.add("loading-indicator-visible"),u.value=await M(e),n==null||n.classList.remove("loading-indicator-visible");else{const o=localStorage.getItem("trending-movies"),s=localStorage.getItem("cache-date");if(o&&s&&w(new Date(s))<=4)u.value=JSON.parse(o);else{n==null||n.classList.add("loading-indicator-visible");const t=await x();localStorage.setItem("trending-movies",JSON.stringify(t)),localStorage.setItem("cache-date",new Date().toString()),n==null||n.classList.remove("loading-indicator-visible"),u.value=t}}}async function x(){const e=await fetch(v+"data/trending-movies.json");if(e.ok){const n=await e.json();return b(n)}else return[]}async function M(e){const n=await fetch(v+"data/movies.json");if(!n.ok)throw new Error;return b(await n.json()).filter(s=>{const t=e.searchQuery.trim();return!(t.length>0&&!s.title.toUpperCase().includes(t.toUpperCase())||e.recent&&s.year!==new Date().getFullYear()||e.goodRating&&s.rating<8||e.genres.length>0&&!e.genres.some(r=>s.genres.includes(r)))}).slice(0,20)}function b(e){return e.map(o=>({title:o.title,runtime:o.runtimeStr,genres:o.genres.split(", "),posterUrl:o.image,moreInfoPageUrl:E+"/"+o.id,year:+o.year,rating:+o.rating}))}window.addEventListener("load",()=>{var g,d,m,a;const e=document.querySelector(".sidebar"),n=document.querySelector(".error-text"),o=document.getElementById("recentCheckbox"),s=document.getElementById("goodRatingCheckbox"),t=document.querySelectorAll('.genre-filters-spoiler input[type="checkbox"]'),r=document.querySelector(".search-query-field");(g=document.querySelector(".expanded-content"))==null||g.addEventListener("submit",i),(d=document.querySelector(".expand-button"))==null||d.addEventListener("click",c),(m=document.querySelector(".open-sidebar-button"))==null||m.addEventListener("click",c),(a=document.querySelector(".minimize-button"))==null||a.addEventListener("click",f);function c(){e==null||e.classList.add("sidebar-expanded"),e==null||e.classList.remove("sidebar-static")}function f(){e==null||e.classList.remove("sidebar-expanded"),setTimeout(()=>{e==null||e.classList.add("sidebar-static")},400)}function i(l){var y;l.preventDefault();const S=r.value.trim();n==null||n.classList.remove("error-text-visible");const h={searchQuery:S,genres:[],recent:o.checked,goodRating:s.checked};t.forEach(p=>{p.checked&&h.genres.push(p.value)}),e==null||e.classList.remove("sidebar-expanded"),(y=document.querySelector(".no-results-text"))==null||y.classList.remove("no-results-text-visible"),L(h)}});
